 SELECT s.user_id,
s.group_id,
t.teacher_id,
t.email AS teacher_email
FROM group_student AS s
INNER JOIN teacher AS t
ON s.group_id = t.group_id
WHERE t.email = 'blanda.jamil@yahoo.com';
 
SELECT s.user_id,
s.level,
u.user_id,
u.user_email AS user_email
FROM student AS s
INNER JOIN users AS u
ON s.user_id = u.user_id
WHERE u.user_email = 'gpagac@jacobs.com';

 SELECT DISTINCT s.subject_title,
s.subject_id,
u.user_id,
u.subject_id AS subject_id
FROM subject AS s
INNER JOIN users AS u
ON s.subject_id = u.subject_id
WHERE u.user_id=11300;

SELECT DISTINCT g.user_id,
g.group_id,
s.user_id,
s.level,
s.subject_id AS subject_id
FROM student AS s
INNER JOIN group_student AS g
ON s.user_id = g.user_id
WHERE g.group_id = 10;


CREATE TABLE Positions ( 
    id_check  INTEGER,
	id_pos INTEGER,
	art CHAR(3),
    quantity INTEGER
);
INSERT INTO Positions (id_check, id_pos, art, quantity)
VALUES
(1, 1, 'A1', 1),
(1, 2, 'A4', 3),
(1, 3, 'A2', 2),
(1, 4, 'A10', 1),
(1, 5, 'A8', 4),
(2, 1, 'A5', 1),
(2, 2, 'A7', 1),
(2, 3, 'A3', 2),
(3, 1, 'A2', 1),
(3, 2, 'A9', 1),
(3, 3, 'A5', 2),
(3, 4, 'A6', 1),
(3, 5, 'A3', 3),
(4, 1, 'A1', 3),
(4, 2, 'A2', 1),
(5, 1, 'A2', 1),
(5, 2, 'A8', 5),
(5, 3, 'A3', 1),
(5, 4, 'A4', 1),
(5, 5, 'A5', 1);
CREATE TABLE Products ( 
	art CHAR(3),
    product CHAR(50),
	category CHAR(50)
);
INSERT INTO Products (art, product, category)
VALUES
('A1', 'кроссовки', 'обувь'),
('A2', 'кеды', 'обувь'),
('A3', 'сланцы', 'обувь'),
('A4', 'куртка', 'одежда'),
('A5', 'ветровка', 'одежда'),
('A6', 'шорты', 'одежда'),
('A7', 'палатка', 'туризм'),
('A8', 'коврик', 'туризм'),
('A9', 'спальник', 'туризм'),
('A10', 'рюкзак', 'туризм'),
('A11', 'туфли', 'обувь'),
('A12', 'солнечные очки', 'аксессуары');

 SELECT DISTINCT Pr.category,
            P.id_pos,
P.id_check AS id_check
FROM Positions AS P
INNER JOIN Products AS Pr
ON P.art = Pr.art
WHERE P.id_check = 3;

SELECT Pr.product,
P.id_check,
Pr.art,
P.art
FROM Positions AS P
FULL OUTER JOIN Products AS Pr
ON Pr.art = P.art
WHERE P.id_check IS NULL

SELECT COUNT(P.id_check), Pr.category, sum(P.quantity), P.id_check
FROM Positions AS P
JOIN Products AS Pr
ON P.art = Pr.art
WHERE Pr.category = 'обувь'
GROUP BY P.id_check, Pr.category
HAVING SUM(P.quantity) > 2;

SELECT COUNT(P.id_check), Pr.category, sum(P.quantity), P.id_check
FROM Positions AS P
JOIN Products AS Pr
ON P.art = Pr.art
WHERE Pr.category = 'одежда'
GROUP BY P.id_check, Pr.category
HAVING SUM(P.quantity) > 2;


